{
  "$defs": {
    "Annotation": {
      "description": "Annotation metadata preserved in IR.\n\n`name` is the annotation identifier without the `@` prefix.\n`argument`, when present, is fully resolved as a Value.",
      "properties": {
        "argument": {
          "allOf": [
            {
              "$ref": "#/$defs/Value"
            },
            {
              "description": "Optional resolved argument payload"
            }
          ]
        },
        "name": {
          "description": "Annotation name without `@`",
          "type": "string"
        }
      },
      "required": [
        "name"
      ],
      "type": "object"
    },
    "ConstantDef": {
      "description": "Fully resolved constant definition.\n\n`typeRef` is explicit or inferred by analysis.\n`value` contains the fully resolved literal payload.",
      "properties": {
        "annotations": {
          "description": "Constant annotations in source order",
          "items": {
            "$ref": "#/$defs/Annotation"
          },
          "type": "array"
        },
        "doc": {
          "description": "Optional constant documentation",
          "type": "string"
        },
        "name": {
          "description": "Constant name",
          "type": "string"
        },
        "typeRef": {
          "allOf": [
            {
              "$ref": "#/$defs/TypeRef"
            },
            {
              "description": "Normalized constant type reference (explicit or inferred)"
            }
          ]
        },
        "value": {
          "allOf": [
            {
              "$ref": "#/$defs/Value"
            },
            {
              "description": "Fully resolved constant value"
            }
          ]
        }
      },
      "required": [
        "annotations",
        "name",
        "typeRef",
        "value"
      ],
      "type": "object"
    },
    "DocDef": {
      "description": "Standalone documentation block.\n\nUsed for top-level docstrings that are not attached to a type/enum/constant.",
      "properties": {
        "content": {
          "description": "Resolved documentation content",
          "type": "string"
        }
      },
      "required": [
        "content"
      ],
      "type": "object"
    },
    "EnumDef": {
      "description": "Flattened enum definition.\n\nAll enum spreads are already expanded into `members`.",
      "properties": {
        "annotations": {
          "description": "Enum annotations in source order",
          "items": {
            "$ref": "#/$defs/Annotation"
          },
          "type": "array"
        },
        "doc": {
          "description": "Optional enum documentation",
          "type": "string"
        },
        "enumType": {
          "allOf": [
            {
              "$ref": "#/$defs/EnumType"
            },
            {
              "description": "Enum underlying storage kind"
            }
          ]
        },
        "members": {
          "description": "Enum members in source order after spread expansion",
          "items": {
            "$ref": "#/$defs/EnumDefMember"
          },
          "type": "array"
        },
        "name": {
          "description": "Enum name",
          "type": "string"
        }
      },
      "required": [
        "annotations",
        "enumType",
        "members",
        "name"
      ],
      "type": "object"
    },
    "EnumDefMember": {
      "description": "Enum member definition",
      "properties": {
        "annotations": {
          "description": "Member annotations in source order",
          "items": {
            "$ref": "#/$defs/Annotation"
          },
          "type": "array"
        },
        "doc": {
          "description": "Optional member documentation",
          "type": "string"
        },
        "name": {
          "description": "Member name",
          "type": "string"
        },
        "value": {
          "description": "Canonical string representation of the member value",
          "type": "string"
        }
      },
      "required": [
        "annotations",
        "name",
        "value"
      ],
      "type": "object"
    },
    "EnumType": {
      "description": "Underlying storage kind used by an enum",
      "enum": [
        "string",
        "int"
      ],
      "type": "string"
    },
    "Field": {
      "description": "Flattened object/type field definition",
      "properties": {
        "annotations": {
          "description": "Field annotations in source order",
          "items": {
            "$ref": "#/$defs/Annotation"
          },
          "type": "array"
        },
        "doc": {
          "description": "Optional field documentation",
          "type": "string"
        },
        "name": {
          "description": "Field name",
          "type": "string"
        },
        "optional": {
          "description": "True when the field is optional (`?`)",
          "type": "boolean"
        },
        "typeRef": {
          "allOf": [
            {
              "$ref": "#/$defs/TypeRef"
            },
            {
              "description": "Normalized field type reference"
            }
          ]
        }
      },
      "required": [
        "annotations",
        "name",
        "optional",
        "typeRef"
      ],
      "type": "object"
    },
    "IrSchema": {
      "description": "IrSchema is the generator-facing representation of a VDL program.\n\nThis model is intentionally \"flat\" and \"resolved\":\n- spreads are already expanded\n- references are already resolved\n- collections are in deterministic order\n\nA code generator should be able to consume IrSchema directly, without needing\nto re-run parser or semantic-analysis logic.",
      "properties": {
        "constants": {
          "description": "Constant definitions, sorted by name",
          "items": {
            "$ref": "#/$defs/ConstantDef"
          },
          "type": "array"
        },
        "docs": {
          "description": "Standalone documentation blocks in source traversal order",
          "items": {
            "$ref": "#/$defs/DocDef"
          },
          "type": "array"
        },
        "enums": {
          "description": "Enum definitions, sorted by name",
          "items": {
            "$ref": "#/$defs/EnumDef"
          },
          "type": "array"
        },
        "types": {
          "description": "Type definitions, sorted by name",
          "items": {
            "$ref": "#/$defs/TypeDef"
          },
          "type": "array"
        }
      },
      "required": [
        "constants",
        "docs",
        "enums",
        "types"
      ],
      "type": "object"
    },
    "ObjectEntry": {
      "description": "Key/value pair inside an object Value payload",
      "properties": {
        "key": {
          "description": "Object key",
          "type": "string"
        },
        "value": {
          "allOf": [
            {
              "$ref": "#/$defs/Value"
            },
            {
              "description": "Fully resolved value for this key"
            }
          ]
        }
      },
      "required": [
        "key",
        "value"
      ],
      "type": "object"
    },
    "PrimitiveType": {
      "description": "Primitive scalar type names",
      "enum": [
        "string",
        "int",
        "float",
        "bool",
        "datetime"
      ],
      "type": "string"
    },
    "TypeDef": {
      "description": "Flattened type definition.\n\nAll spreads are already expanded into `fields`.",
      "properties": {
        "annotations": {
          "description": "Type annotations in source order",
          "items": {
            "$ref": "#/$defs/Annotation"
          },
          "type": "array"
        },
        "doc": {
          "description": "Optional type documentation",
          "type": "string"
        },
        "fields": {
          "description": "Type fields in source order",
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array"
        },
        "name": {
          "description": "Type name",
          "type": "string"
        }
      },
      "required": [
        "annotations",
        "fields",
        "name"
      ],
      "type": "object"
    },
    "TypeKind": {
      "description": "Kind discriminator for TypeRef",
      "enum": [
        "primitive",
        "type",
        "enum",
        "array",
        "map",
        "object"
      ],
      "type": "string"
    },
    "TypeRef": {
      "description": "Normalized type reference used by fields and constants.\n\n`kind` selects which payload fields are meaningful. Generators should inspect\n`kind` first, then read the related payload fields.",
      "properties": {
        "arrayDims": {
          "description": "Array rank when `kind` is `array` (for example, 2 for `T[][]`)",
          "type": "integer"
        },
        "arrayType": {
          "allOf": [
            {
              "$ref": "#/$defs/TypeRef"
            },
            {
              "description": "Element type when `kind` is `array`"
            }
          ]
        },
        "enumName": {
          "description": "Referenced enum name when `kind` is `enum`",
          "type": "string"
        },
        "enumType": {
          "allOf": [
            {
              "$ref": "#/$defs/EnumType"
            },
            {
              "description": "Referenced enum underlying kind when `kind` is `enum`"
            }
          ]
        },
        "kind": {
          "allOf": [
            {
              "$ref": "#/$defs/TypeKind"
            },
            {
              "description": "Type category discriminator"
            }
          ]
        },
        "mapType": {
          "allOf": [
            {
              "$ref": "#/$defs/TypeRef"
            },
            {
              "description": "Map value type when `kind` is `map`"
            }
          ]
        },
        "objectFields": {
          "description": "Inline object fields when `kind` is `object`",
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array"
        },
        "primitiveName": {
          "allOf": [
            {
              "$ref": "#/$defs/PrimitiveType"
            },
            {
              "description": "Primitive type name when `kind` is `primitive`"
            }
          ]
        },
        "typeName": {
          "description": "Referenced type name when `kind` is `type`",
          "type": "string"
        }
      },
      "required": [
        "kind"
      ],
      "type": "object"
    },
    "Value": {
      "description": "Fully resolved literal value.\n\nThe selected payload is determined by `kind`:\n- `string` -\u003e `stringValue`\n- `int` -\u003e `intValue`\n- `float` -\u003e `floatValue`\n- `bool` -\u003e `boolValue`\n- `object` -\u003e `objectEntries`\n- `array` -\u003e `arrayItems`",
      "properties": {
        "arrayItems": {
          "description": "Payload for `kind = array`",
          "items": {
            "$ref": "#/$defs/Value"
          },
          "type": "array"
        },
        "boolValue": {
          "description": "Payload for `kind = bool`",
          "type": "boolean"
        },
        "floatValue": {
          "description": "Payload for `kind = float`",
          "type": "number"
        },
        "intValue": {
          "description": "Payload for `kind = int`",
          "type": "integer"
        },
        "kind": {
          "allOf": [
            {
              "$ref": "#/$defs/ValueKind"
            },
            {
              "description": "Value category discriminator"
            }
          ]
        },
        "objectEntries": {
          "description": "Payload for `kind = object`",
          "items": {
            "$ref": "#/$defs/ObjectEntry"
          },
          "type": "array"
        },
        "stringValue": {
          "description": "Payload for `kind = string`",
          "type": "string"
        }
      },
      "required": [
        "kind"
      ],
      "type": "object"
    },
    "ValueKind": {
      "description": "Kind discriminator for Value.\n\nValue is used for fully resolved literal data in:\n- constant values\n- annotation arguments",
      "enum": [
        "string",
        "int",
        "float",
        "bool",
        "object",
        "array"
      ],
      "type": "string"
    }
  },
  "$id": "https://vdl.varavel.com/schemas/v0/ir.schema.json",
  "$ref": "#/$defs/IrSchema",
  "$schema": "https://json-schema.org/draft/2020-12/schema"
}