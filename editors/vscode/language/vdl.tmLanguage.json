{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "VDL (Varavel Definition Language)",
  "scopeName": "source.vdl",
  "config": {
    "name": "VDL (Varavel Definition Language)"
  },
  "fileTypes": ["vdl"],
  "patterns": [
    { "include": "#comments" },
    { "include": "#docstrings" },
    { "include": "#strings" },
    { "include": "#declarations" },
    { "include": "#keywords" },
    { "include": "#functions-macros" },
    { "include": "#constants-language" },
    { "include": "#constants-numeric" },
    { "include": "#constants-usage" },
    { "include": "#types-primitive" },
    { "include": "#types-container" },
    { "include": "#types-usage" },
    { "include": "#operators" },
    { "include": "#properties" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.double-slash.vdl",
          "match": "//.*$"
        },
        {
          "name": "comment.block.vdl",
          "begin": "/\\*",
          "end": "\\*/"
        }
      ]
    },
    "docstrings": {
      "name": "string.quoted.docstring.multi.vdl",
      "begin": "\"\"\"",
      "end": "\"\"\"",
      "patterns": [
        {
          "match": "(\\./[a-zA-Z0-9_\\-\\./]+\\.md)",
          "captures": {
            "1": { "name": "markup.underline.link.vdl" }
          }
        }
      ]
    },
    "strings": {
      "name": "string.quoted.double.vdl",
      "begin": "\"",
      "end": "\"",
      "patterns": [
        {
          "name": "constant.character.escape.vdl",
          "match": "\\\\."
        },
        {
          "name": "variable.other.pattern.placeholder.vdl",
          "match": "\\{[a-zA-Z0-9_]+\\}"
        }
      ]
    },
    "declarations": {
      "patterns": [
        {
          "name": "meta.declaration.type.vdl",
          "match": "\\b(type|enum)\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": { "name": "keyword.control.vdl" },
            "2": { "name": "entity.name.type.class.vdl" }
          }
        },
        {
          "name": "meta.declaration.rpc.vdl",
          "match": "\\b(rpc)\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": { "name": "keyword.control.vdl" },
            "2": { "name": "entity.name.type.class.vdl" }
          }
        },
        {
          "name": "meta.declaration.function.vdl",
          "match": "\\b(proc|stream|pattern)\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": { "name": "keyword.control.vdl" },
            "2": { "name": "entity.name.function.vdl" }
          }
        },
        {
          "name": "meta.declaration.constant.vdl",
          "match": "\\b(const)\\s+([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": { "name": "keyword.control.vdl" },
            "2": { "name": "variable.other.constant.vdl" }
          }
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.vdl",
          "match": "\\b(include|input|output)\\b"
        }
      ]
    },
    "functions-macros": {
      "patterns": [
        {
          "name": "keyword.other.deprecated.vdl",
          "match": "\\bdeprecated\\b"
        },
        {
          "begin": "\\b(deprecated)\\s*(\\()",
          "beginCaptures": {
            "1": { "name": "keyword.other.deprecated.vdl" },
            "2": { "name": "punctuation.definition.parameters.begin.vdl" }
          },
          "end": "\\)",
          "endCaptures": {
            "0": { "name": "punctuation.definition.parameters.end.vdl" }
          },
          "patterns": [{ "include": "#strings" }]
        }
      ]
    },
    "constants-language": {
      "patterns": [
        {
          "name": "constant.language.boolean.vdl",
          "match": "\\b(true|false)\\b"
        }
      ]
    },
    "constants-numeric": {
      "patterns": [
        {
          "name": "constant.numeric.float.vdl",
          "match": "\\b\\d+\\.\\d+\\b"
        },
        {
          "name": "constant.numeric.integer.vdl",
          "match": "\\b\\d+\\b"
        }
      ]
    },
    "constants-usage": {
      "patterns": [
        {
          "comment": "Matches UPPER_CASE identifiers as constants references",
          "name": "variable.other.constant.vdl",
          "match": "\\b[A-Z][A-Z0-9_]*_\\w+\\b|\\b[A-Z]{2,}\\b"
        }
      ]
    },
    "types-primitive": {
      "patterns": [
        {
          "name": "storage.type.primitive.vdl",
          "match": "\\b(string|int|float|bool|datetime)\\b"
        }
      ]
    },
    "types-container": {
      "patterns": [
        {
          "name": "storage.type.container.vdl",
          "match": "\\b(map)\\b"
        }
      ]
    },
    "types-usage": {
      "patterns": [
        {
          "comment": "Matches PascalCase identifiers as Types/Enums references",
          "name": "entity.name.type.class.vdl",
          "match": "\\b[A-Z][a-zA-Z0-9]*\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.spread.vdl",
          "match": "\\.\\.\\."
        },
        {
          "name": "keyword.operator.optional.vdl",
          "match": "\\?"
        },
        {
          "name": "keyword.operator.assignment.vdl",
          "match": "="
        },
        {
          "name": "punctuation.separator.key-value.vdl",
          "match": ":"
        },
        {
          "name": "punctuation.terminator.vdl",
          "match": ","
        },
        {
          "name": "punctuation.definition.type.begin.vdl",
          "match": "<"
        },
        {
          "name": "punctuation.definition.type.end.vdl",
          "match": ">"
        },
        {
          "name": "punctuation.section.braces.begin.vdl",
          "match": "\\{"
        },
        {
          "name": "punctuation.section.braces.end.vdl",
          "match": "\\}"
        },
        {
          "name": "punctuation.section.brackets.begin.vdl",
          "match": "\\["
        },
        {
          "name": "punctuation.section.brackets.end.vdl",
          "match": "\\]"
        },
        {
          "name": "punctuation.definition.parameters.begin.vdl",
          "match": "\\("
        },
        {
          "name": "punctuation.definition.parameters.end.vdl",
          "match": "\\)"
        }
      ]
    },
    "properties": {
      "patterns": [
        {
          "comment": "Matches properties like field: Type",
          "name": "variable.object.property.vdl",
          "match": "\\b[a-z][a-zA-Z0-9_]*\\b(?=\\s*(\\?|:))"
        }
      ]
    }
  }
}
