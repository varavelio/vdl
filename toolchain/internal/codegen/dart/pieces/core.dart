// Code generated by VDL. DO NOT EDIT.
// If you edit this file, it will be overwritten the next time it is generated.
//
// This file is licensed under the MIT License.
// See https://github.com/varavelio/vdl for more information.
//
// Copyright (c) [Generated by VDL - User retains copyright]
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.

// ignore_for_file: unused_element, unused_field

// -----------------------------------------------------------------------------
// Core Types
// -----------------------------------------------------------------------------

/// Response represents the response of a VDL call.
class Response<T> {
  /// Indicates whether the RPC call was successful.
  final bool ok;

  /// The successful output (only present if `ok == true`).
  final T? output;

  /// Structured error (only present if `ok == false`).
  final VdlError? error;

  const Response._({required this.ok, this.output, this.error});

  factory Response.ok(T output) => Response._(ok: true, output: output);

  factory Response.error(VdlError error) => Response._(ok: false, error: error);

  factory Response.fromJson(Map<String, dynamic> json) {
    if (json['ok'] == true) {
      return Response.ok(json['output'] as T);
    }
    final err = json['error'];
    return Response.error(
      err is Map<String, dynamic>
          ? VdlError.fromJson(err)
          : VdlError(message: err?.toString() ?? 'Unknown error'),
    );
  }

  Map<String, dynamic> toJson() {
    if (ok) {
      return {'ok': true, 'output': output};
    }
    return {'ok': false, 'error': error?.toJson()};
  }
}

/// Structured error type used throughout the VDL ecosystem.
class VdlError implements Exception {
  /// Human-readable description of the error.
  final String message;

  /// Categorizes the error by its nature or source (e.g., "ValidationError").
  final String? category;

  /// Machine-readable identifier for the specific error condition.
  final String? code;

  /// Additional information about the error.
  final Map<String, dynamic>? details;

  VdlError({required this.message, this.category, this.code, this.details});

  factory VdlError.fromJson(Map<String, dynamic> json) => VdlError(
    message: json['message']?.toString() ?? 'Unknown error',
    category: json['category'] as String?,
    code: json['code'] as String?,
    details: json['details'] is Map
        ? (json['details'] as Map).cast<String, dynamic>()
        : null,
  );

  Map<String, dynamic> toJson() {
    final data = <String, dynamic>{'message': message};
    if (category != null) data['category'] = category;
    if (code != null) data['code'] = code;
    if (details != null) data['details'] = details;
    return data;
  }

  @override
  String toString() =>
      'VdlError(message: ' + message + ', code: ' + (code ?? '-') + ')';
}
