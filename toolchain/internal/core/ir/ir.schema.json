{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://vdl.varavel.com/schemas/v0/ir.schema.json",
  "$defs": {
    "Constant": {
      "properties": {
        "name": {
          "type": "string",
          "description": "The unique name of the constant"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the constant"
        },
        "deprecated": {
          "$ref": "#/$defs/Deprecation",
          "description": "Deprecation status if deprecated"
        },
        "valueType": {
          "type": "string",
          "description": "The type of the constant value"
        },
        "value": {
          "type": "string",
          "description": "The value of the constant as a string"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "valueType",
        "value"
      ]
    },
    "Deprecation": {
      "properties": {
        "message": {
          "type": "string",
          "description": "A message explaining the deprecation and suggested alternative"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Doc": {
      "properties": {
        "rpcName": {
          "type": "string",
          "description": "The name of the RPC service this doc belongs to, if empty this is a global standalone documentation block"
        },
        "content": {
          "type": "string",
          "description": "The content of the documentation"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "content"
      ]
    },
    "Enum": {
      "properties": {
        "name": {
          "type": "string",
          "description": "The unique name of the enum"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the enum"
        },
        "deprecated": {
          "$ref": "#/$defs/Deprecation",
          "description": "Deprecation status if deprecated"
        },
        "valueType": {
          "type": "string",
          "description": "The type of values contained in this enum"
        },
        "members": {
          "items": {
            "$ref": "#/$defs/EnumMember"
          },
          "type": "array",
          "description": "List of enum members"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "valueType",
        "members"
      ]
    },
    "EnumInfo": {
      "properties": {
        "valueType": {
          "type": "string",
          "description": "The underlying value type of the enum (string or int)"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "valueType"
      ]
    },
    "EnumMember": {
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the enum member"
        },
        "value": {
          "type": "string",
          "description": "The value of the enum member"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "value"
      ]
    },
    "Field": {
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the field"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the field"
        },
        "optional": {
          "type": "boolean",
          "description": "Whether the field is optional"
        },
        "type": {
          "$ref": "#/$defs/TypeRef",
          "description": "The type definition of the field"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "type"
      ]
    },
    "InlineObject": {
      "properties": {
        "fields": {
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array",
          "description": "List of fields in the inline object"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "fields"
      ]
    },
    "Pattern": {
      "properties": {
        "name": {
          "type": "string",
          "description": "The unique name of the pattern"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the pattern"
        },
        "deprecated": {
          "$ref": "#/$defs/Deprecation",
          "description": "Deprecation status if deprecated"
        },
        "template": {
          "type": "string",
          "description": "The template string containing placeholders"
        },
        "placeholders": {
          "items": {
            "type": "string"
          },
          "type": "array",
          "description": "List of placeholder names extracted from the template"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "template",
        "placeholders"
      ]
    },
    "Procedure": {
      "properties": {
        "rpcName": {
          "type": "string",
          "description": "The name of the parent RPC service"
        },
        "name": {
          "type": "string",
          "description": "The name of the procedure"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the procedure"
        },
        "deprecated": {
          "$ref": "#/$defs/Deprecation",
          "description": "Deprecation status if deprecated"
        },
        "input": {
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array",
          "description": "List of input parameters"
        },
        "output": {
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array",
          "description": "List of output parameters"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "rpcName",
        "name",
        "input",
        "output"
      ]
    },
    "RPC": {
      "properties": {
        "name": {
          "type": "string",
          "description": "The unique name of the RPC service"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the RPC service"
        },
        "deprecated": {
          "$ref": "#/$defs/Deprecation",
          "description": "Deprecation status if deprecated"
        },
        "procs": {
          "items": {
            "$ref": "#/$defs/Procedure"
          },
          "type": "array",
          "description": "List of procedures in this RPC"
        },
        "streams": {
          "items": {
            "$ref": "#/$defs/Stream"
          },
          "type": "array",
          "description": "List of streams in this RPC"
        },
        "docs": {
          "items": {
            "type": "string"
          },
          "type": "array",
          "description": "Standalone documentation blocks specific to this RPC"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "procs",
        "streams"
      ]
    },
    "Stream": {
      "properties": {
        "rpcName": {
          "type": "string",
          "description": "The name of the parent RPC service"
        },
        "name": {
          "type": "string",
          "description": "The name of the stream"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the stream"
        },
        "deprecated": {
          "$ref": "#/$defs/Deprecation",
          "description": "Deprecation status if deprecated"
        },
        "input": {
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array",
          "description": "List of input parameters"
        },
        "output": {
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array",
          "description": "List of output parameters"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "rpcName",
        "name",
        "input",
        "output"
      ]
    },
    "Type": {
      "properties": {
        "name": {
          "type": "string",
          "description": "The unique name of the type"
        },
        "doc": {
          "type": "string",
          "description": "Documentation for the type"
        },
        "deprecated": {
          "$ref": "#/$defs/Deprecation",
          "description": "Deprecation status if deprecated"
        },
        "fields": {
          "items": {
            "$ref": "#/$defs/Field"
          },
          "type": "array",
          "description": "List of fields in the type"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "fields"
      ]
    },
    "TypeRef": {
      "properties": {
        "kind": {
          "type": "string",
          "description": "The category of the type (primitive, type, enum, array, map, object)"
        },
        "primitive": {
          "type": "string",
          "description": "The specific primitive type if Kind is primitive"
        },
        "type": {
          "type": "string",
          "description": "The name of the custom type if Kind is type"
        },
        "enum": {
          "type": "string",
          "description": "The name of the enum if Kind is enum"
        },
        "enumInfo": {
          "$ref": "#/$defs/EnumInfo",
          "description": "Additional metadata for enum types"
        },
        "arrayItem": {
          "$ref": "#/$defs/TypeRef",
          "description": "The type of elements in the array if Kind is array"
        },
        "arrayDimensions": {
          "type": "integer",
          "description": "Number of array dimensions (e.g. 2 for int[][])"
        },
        "mapValue": {
          "$ref": "#/$defs/TypeRef",
          "description": "The type of values in the map if Kind is map"
        },
        "object": {
          "$ref": "#/$defs/InlineObject",
          "description": "Definition of the inline object if Kind is object"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "kind"
      ]
    }
  },
  "properties": {
    "types": {
      "items": {
        "$ref": "#/$defs/Type"
      },
      "type": "array",
      "description": "List of all type definitions in the schema"
    },
    "enums": {
      "items": {
        "$ref": "#/$defs/Enum"
      },
      "type": "array",
      "description": "List of all enum definitions in the schema"
    },
    "constants": {
      "items": {
        "$ref": "#/$defs/Constant"
      },
      "type": "array",
      "description": "List of all constant definitions in the schema"
    },
    "patterns": {
      "items": {
        "$ref": "#/$defs/Pattern"
      },
      "type": "array",
      "description": "List of all pattern definitions in the schema"
    },
    "rpcs": {
      "items": {
        "$ref": "#/$defs/RPC"
      },
      "type": "array",
      "description": "List of all RPC service definitions in the schema"
    },
    "procedures": {
      "items": {
        "$ref": "#/$defs/Procedure"
      },
      "type": "array",
      "description": "Flattened list of all procedures from all RPCs"
    },
    "streams": {
      "items": {
        "$ref": "#/$defs/Stream"
      },
      "type": "array",
      "description": "Flattened list of all streams from all RPCs"
    },
    "docs": {
      "items": {
        "$ref": "#/$defs/Doc"
      },
      "type": "array",
      "description": "List of all standalone documentation blocks (even from all RPCs)"
    }
  },
  "additionalProperties": false,
  "type": "object",
  "required": [
    "types",
    "enums",
    "constants",
    "patterns",
    "rpcs",
    "procedures",
    "streams",
    "docs"
  ],
  "title": "VDL IR Schema",
  "description": "JSON Schema for the VDL Intermediate Representation"
}